2022 05/23
 Spring Study

 스프링의 핵심
 - 스프링은 좋은 객체 지향 애플리케이션을 개발할 수 있게 도와주는 프레임 워크.
 
 다형성
 - 역할 = 인터페이스, 구현 = 인터페이스를 구현한 클래스. 구현체로 분리
 - 객체 설계시 인터페이스를 먼저 부여하고, 그 역할을 수행하는 구현 객체를 만듦
 
5/24 
 비즈니스 요구사항과 설계
 - 요구사항은 개발과 항상 결정되는것이 아닌, 추후에 정책이 결정될 수 있다.
   그렇다고 정책이 정해질때 까지 개발을 무기한 연장할수는 없다.
   먼저 인터페이스를 만들고 구현체를 언제든지 갈아끼울 수 있도록 설계하면 된다.
  
  스프링사용전, 순수 자바코드로 클라이언트 -> 회원 서비스 -> 메모리 회원 저장소(미정) 생성하기.
  
 8/01 다시 시작
 회원 도메인 요구사항
- 회원을 가입하고 조회할 수 있다
- 회원은 일반과 VIP 두 가지 등급이 있다
- 회원 데이터는 자체DB를 구축할수 있고, 외부 시스템과 연동할수 있다(미확정)

9/13
- 회원을 메모리가 아닌 실제 DB에서 조회하고, 정률할인정책(%) 또는 정액할인정책(금액) 을 지원해도
  주문서비스를 변경하지 않아도 된다.
- 협력관계 그대로 재사용 할 수 있다.
- *항상 테스트 코드를 작성해야 한다. 성공 케이스 뿐만 아니라 실패 케이스도 함께.

9/14
- OrderServiceImpl이 DiscountPolicy의 인터페이스 뿐만 아니라 구현클래스도 의존하는상황
- AppConfig를 통해 실제 동작에 필요한 구현 객체를 생성후 생성자를 통해서 주입(연결)한다.
  -> DIP 위반. 추상에만 의존하도록 변경(인터페이스에만 의존)
- DIP 의존관계 역전 원칙 (Dependency Inversion Principle)이란?
  의존 관계를 맺을때 변화하기 쉬운 것 또는 자주 변화하는 것에 의존하기 보다는 변화하기 어려운것, 거의 변화가 없는것에 의존해야함
  즉, 변하지 않는것(인터페이스) 에 의존하고, 변하기 쉬운것(구현체 클래스) 에는 의존x
  
 스프링 컨테이너 생성
- ApplicationContext를 스프링 컨테이너라 한다.
- 스프링 컨테이너 생성 new AnnotationConfigApplicationContext(Appconfig.class);
  이 클래스는 ApplicationContext 인터페이스의 구현체 이다.
  스프링 컨테이너를 생성할 때는 구성 정보를 지정해 주어야 한다. 그게 바로 Appconfig.class를 파라미터로 넘긴 이유이다.
  스프링 컨테이너는 파라미터로 넘어온 설정 클래스 정보를 사용해서 스프링빈(@Bean)을 등록한다
  빈 이름은 메서드 이름을 사용하며, 항상 다르게 부여해야 한다.

9/15
  스프링 빈 조회 - 상속관계
- 부모 타입으로 조회하면, 자식 타입도 함께 조회한다.
- 그래서 모든 자바 객체의 최고 부모인 Object 타입으로 조회하면 모든 스프링 빈을 조회한다.

  BeanFactory
- 스프링 컨테이너의 최상위 인터페이스이다.
- 스프링 빈을 관리하고 조회하는 역할을 한다.
- getBean()을 제공한다

  ApplicationContext
- BeanFactory 기능을 모두 상속받아서 제공한다
- 애플리케이션을 개발할때는 빈을 관리하고 조회하는 기능뿐만 아니라 수 많은 부가 기능이 필요하다.
  ApplicationContext가 상속받는 다양한 인터페이스
  MessageSource 메세지소스를 활용한 국제화 기능
- 한국에서 들어오면 한국어로, 영어권에서 들어오면 영어로 출력
  EnvironmentCapable 환경변수
- 로컬, 개발, 운영 등을 구분해서 처리
  ApplicationEventPublisher 애플리케이션 이벤트
- 이벤트를 발행하고 구독하는 모델을 편리하게 지원
  ResourceLoader 편리한 리소스 조회 
- 파일, 클래스패스, 외부 등에서 리소스를 편리하게 조회

  정리
- ApplicationContext는 BeanFactory의 기능을 상속받는다
- ApplicationContext는 빈 관리기능 + 편리한 부가 기능을 제공한다
- BeanFactory를 직접 사용할 일은 거의 없다. 부가기능이 포함된 ApplicationContext를 사용한다. 
- BeanFactory나 ApplicationContext를 스프릴 컨테이너라 한다.

  싱글톤 패턴
- 지금까지 만든 순수한 DI컨테이너인 AppConfig는 요청을 할 때 마다 객체를 새로 생성한다
- 고객 트래픽이 초당 1000이라면 초당 1000개의 객체가 생성 소멸 된다 -> 메모리 낭비
- 싱글톤 패턴은 클래스의 인스턴스가 딱 1개만 생성되는것을 보장하는 디자인 패턴이다.
- 단, 여러가지 문제점이 존재한다.
- 스프링 컨테이너는 문제점을 모두 해결하면서 객체 인스턴스를 싱글톤(1걔만 생성)으로 관리한다.
- 스프링 빈이 바로 싱글톤으로 관리되는 빈이다. 스프링은 싱글톤 방식으로 작동한다(99%)
- @Bean이 붙은 메서드마다 이미 스프링 빈이 존재하면 존재하는 빈을 반환하고,
  스프링 빈이 없으면 생성해서 스프링빈으로 등록하고 반환하는 코드가 동적으로 만들어 진다. 덕분에 싱글톤이 보장되는 것이다. -> (@Configuration을 사용하는 이유)
  
 9/16
 @ComponentScan
- 스프링은 설정 정보가 없어도 자동으로 스프링 빈을 등록하는 컴포넌트 스캔이라는 기능을 제공한다.
- @Component가 붙은 클래스를 찾아서 자동으로 Bena으로 등록해준다
- 안에 excludeFilter 로 특정 클래스가 등록되지 않도록 지정가능하다.
- 안에 basePackages 로 특정 패키지 하위부터 찾도록 지정이 가능하다. 디폴트는 선언한 해당 패키지가 시작 위치가 된다.
- 생성자에 @Autowired를 지정하면 스프링 컨테이너가 자동으로 해당 스프링 빈을 찾아서 주입한다.
- 컴포넌트 스캔 대상은 @Component이외에도 @Controller, @Service, @Repository, @Configuration이 있다.
  
  의존관계 주입시 생성자 주입을 사용
- 생성자 주입은 객체를 생성할대 딱 1번만 호출되므로 이후에 호출되는 일이 없다. 따라서 불변하게 설계 할 수 있다.
- 주입 데이터를 누락했을때 컴파일 오류가 발생하여 어떤값을 필수로 주입해야 하는지 알 수 있다. 
- final 키워드를 사용하여 생성자에서 혹시라도 값이 설정되지 않는 오류를 컴파일 시점에서 막아준다.
- 생성자가 하나일 경우 @Autowired 생략가능  
- lombok라이브러리의 @RequiredArgsConstructor 사용시, fianl로 선언된 필드의 생성자를 자동으로 만들어줌

9/18
  조회 대상 빈이 2개 이상일때 해결방법
- 1. @Autowired 필드명 매칭
- 2. @Qualifer 끼리 매칭 -> 빈 이름 매칭
- 3. @Primary 사용

  빈 생명주기 콜백
  스프링 빈의 이벤트 라이프 사이클
- 스프링은 의존관계 주입이 완료되면 스프링 빈에게 콜백 메서드를 통해서 초기화 시점을 알려주는 다양한 기능 제공
- 스프링 컨테이너 생성 -> 스프링 빈 생성 -> 의존관계 주입 -> 초기화 콜백 -> 사용 -> 소멸전 콜백 -> 스프링 종료
- 3가지 방법중 @PostConstruct, @PreDestory를 사용하라.

//빈 스코프 부터
  
 
--인텔리제이 단축키
- art + enter 구현체 생성, 임포트(static import)
- art + insert 파일 생성, 생성자, getter/setter생성
- F2 오류난곳으로 바로 이동
- Ctrl + shift + t Test파일 자동생성
- Ctrl + shift + enter  다음줄입력칸으로 자동 이동
- Ctrl + alt + o  import정리
- Ctrl + D  한줄 복사
- Ctrl + x  한줄 삭제
- Ctrl + e  히스토리보기 
- Ctrl + b  사용하는 코드를 보여줌   
- Ctrl + alt + m 리팩토링
- Ctrl + alt + v 변수 추출
- Ctrl + alt + b 구현체로 바로 이동
- Ctrl + F12 해당 파일 내 메서드, 필드 객체 전부 보여줌
- shift + shift 검색
- iter + tap  for문 자동완성
- soutv - 변수명 출력, soutm - 메서드 출력